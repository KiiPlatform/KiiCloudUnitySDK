// ------------------------------------------------------------------------------
//  <autogenerated>
//      This code was generated by a tool.
//      Mono Runtime Version: 4.0.30319.1
// 
//      Changes to this file may cause incorrect behavior and will be lost if 
//      the code is regenerated.
//  </autogenerated>
// ------------------------------------------------------------------------------
using System;
using NUnit.Framework;

namespace KiiCorp.Cloud.Storage
{
    [TestFixture()]
    public class TestKiiUser_ChangeAPI_async
    {
        private MockHttpClient client;

        [SetUp()]
        public void SetUp()
        {
            Kii.Initialize("appId", "appKey", Kii.Site.US);
            MockHttpClientFactory factory = new MockHttpClientFactory();
            Kii.AsyncHttpClientFactory = factory;
            
            client = (MockHttpClient)factory.Client;
        }

        private void LogIn()
        {
            // set Response
            client.AddResponse(200, "{" +
                               "\"id\" : \"user1234\"," +
                               "\"access_token\" : \"cdef\"," +
                               "\"expires_in\" : 9223372036854775}");
            KiiUser.LogIn("kii1234", "pass1234", null);
        }

        #region KiiUser.ChangePassword(newPassword, oldPassword, KiiUserCallback)

        [Test(), KiiUTInfo(
            action = "When we call ChangePassword(callback) and Server returns HTTP 204,",
            expected = "No exception is given"
            )]
        public void Test_0000_ChangePassword ()
        {
            this.LogIn();

            string newPassword = "newPassword";
            string oldPassword = "oldPassword";

            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePassword(newPassword, oldPassword, (Exception e) =>
            {
                done = true;
                exception = e;
            });

            Assert.IsTrue(done);
            Assert.IsNull(exception);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangePassword(callback) with wrong old password and Server returns HTTP 401,",
            expected = "CloudException is given"
            )]
        public void Test_0001_ChangePassword_wrongPassword ()
        {
            this.LogIn();
            
            string newPassword = "newPassword";
            string oldPassword = "oldPassword_wrong";
            
            // set Response
            client.AddResponse(new CloudException(401, 
                    "{" +
                    "\"errorCode\" : \"WRONG_PASSWORD\"," +
                    "\"message\" : \"The provided password is wrong\"," +
                    "\"appID\" : \"appId\"," +
                    "\"userID\" : \"86f3cdcf-950d-4d26-aa1c-443573de1736\"," +
                    "\"suppressed\" : [ ]" +
                    "}"));

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePassword(newPassword, oldPassword, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is CloudException);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangePassword(callback) with null newPassword,",
            expected = "ArgumentException is given"
            )]
        public void Test_0010_ChangePassword_newPassword_null ()
        {
            this.LogIn();
            
            string newPassword = null;
            string oldPassword = "oldPassword";
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePassword(newPassword, oldPassword, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is ArgumentException);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangePassword() with null oldPassword,",
            expected = "ArgumentException is given"
            )]
        public void Test_0011_ChangePassword_oldPassword_null ()
        {
            this.LogIn();
            
            string newPassword = "newPassword";
            string oldPassword = null;
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePassword(newPassword, oldPassword, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is ArgumentException);
        }
        #endregion

        #region KiiUser.ChangeEmail(string email, KiiUserCallback)
        [Test(), KiiUTInfo(
            action = "When we call ChangeEmail(callback) and Server returns HTTP 204,",
            expected = "No exception is given"
            )]
        public void Test_0100_ChangeEmail ()
        {
            this.LogIn();
            
            string newEmail = "test@test.com";
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangeEmail(newEmail, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNull(exception);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangeEmail(callback) and Server returns HTTP 409(Already exists),",
            expected = "CloudException is given"
            )]
        public void Test_0101_ChangeEmail_already_exists ()
        {
            this.LogIn();
            
            string newEmail = "test@test.com";
            
            // set Response
            client.AddResponse(new CloudException(409, 
                    "{" +
                    "\"errorCode\" : \"USER_ALREADY_EXISTS\"," +
                    "\"message\" : \"User with emailAddress test@test.com already exists\"," +
                    "\"value\" : \"test@test.com\"," +
                    "\"field\" : \"emailAddress\"," +
                    "\"suppressed\" : [ ]" +
                    "}"));

            bool done = false;
            Exception exception = null;
            KiiUser.ChangeEmail(newEmail, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is CloudException);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangeEmail(callback) with null,",
            expected = "ArgumentException is given"
            )]
        public void Test_0110_ChangeEmail_null ()
        {
            this.LogIn();
            
            string newEmail = null;
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangeEmail(newEmail, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is ArgumentException);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangeEmail() with invalid email,",
            expected = "ArgumentException is given"
            )]
        public void Test_0111_ChangeEmail_invalid_email ()
        {
            this.LogIn();
            
            string newEmail = "invalidEmailFormat";
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangeEmail(newEmail, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is ArgumentException);
        }
        #endregion

        #region KiiUser.ChangePhone(string phoneNumber, KiiUserCallback callback)
        [Test(), KiiUTInfo(
            action = "When we call ChangePhone(callback) and Server returns HTTP 204,",
            expected = "No exception is given"
            )]
        public void Test_0200_ChangePhone ()
        {
            this.LogIn();
            
            string newPhone = "+818011112222";
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePhone(newPhone, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNull(exception);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangePhone(callback) and Server returns HTTP 409(Already exists),",
            expected = "CloudException is given"
            )]
        public void Test_0201_ChangePhone_already_exists ()
        {
            this.LogIn();
            
            string newPhone = "+818011112222";
            
            // set Response
            client.AddResponse(new CloudException(409, 
                    "{" +
                    "\"errorCode\" : \"USER_ALREADY_EXISTS\"," +
                    "\"message\" : \"User with phoneNumber +818011112222 already exists\"," +
                    "\"value\" : \"+818011112222\"," +
                    "\"field\" : \"phoneNumber\"," +
                    "\"suppressed\" : [ ]" +
                    "}"));

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePhone(newPhone, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is CloudException);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangePhone(callback) witu null,",
            expected = "ArgumentException is given"
            )]
        public void Test_0210_ChangePhone_null ()
        {
            this.LogIn();
            
            string newPhone = null;
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePhone(newPhone, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is ArgumentException);
        }

        [Test(), KiiUTInfo(
            action = "When we call ChangePhone() witu invalid phone number,",
            expected = "ArgumentException is given"
            )]
        public void Test_0211_ChangePhone_invalid_phone_number ()
        {
            this.LogIn();
            
            string newPhone = "invalidPhoneNumber";
            
            // set Response
            client.AddResponse(204, "");

            bool done = false;
            Exception exception = null;
            KiiUser.ChangePhone(newPhone, (Exception e) =>
            {
                done = true;
                exception = e;
            });
            
            Assert.IsTrue(done);
            Assert.IsNotNull(exception);
            Assert.IsTrue(exception is ArgumentException);
        }
        #endregion

    }
}

